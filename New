public void processOrganisationUnit(String orgNumber) {

    // ---------------- STEP 1: Create child org unit ----------------
    InvolvedPartiesOrganisationUnitResponse response = createOrganisationUnit(orgNumber);
    String childUuid = response.getInvolvedPartyIdentifier();

    if (childUuid == null || childUuid.isBlank()) {
        log.warn("No involvedPartyIdentifier found in response");
        return;
    }

    // ---------------- STEP 2: First mandatory sync update ----------------
    UpdateExternalIdentifierOrganisationUnitRequest updateRequest = buildUpdateRequest(orgNumber);
    updateExternalIdentifier(childUuid, updateRequest);

    // ---------------- STEP 3: Resolve Parent UUID from config ----------------
    List<Map<String, String>> configs = configReader.fetchByOrgNumber(orgNumber);
    Map<String, String> config = configs.isEmpty() ? Collections.emptyMap() : configs.get(0);

    String parentUuid = config.get("parentUuid");   // ONLY READ — no changes
    boolean hasParent = parentUuid != null && !parentUuid.isBlank();

    // ---------------- STEP 4: Run 3 tasks in parallel ----------------
    CompletableFuture<Void> addressFuture = CompletableFuture.runAsync(() -> {
        try {
            // calling address service
            onePamRepository.createPostalAddress(childUuid, orgNumber).get();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    });

    CompletableFuture<Void> secondUpdateFuture = CompletableFuture.runAsync(() -> {
        try {
            updateExternalIdentifier(childUuid, updateRequest);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    });

    CompletableFuture<Void> hierarchyFuture;

    if (hasParent) {
        hierarchyFuture = CompletableFuture.runAsync(() -> {
            createOrganisationUnitHierarchy(childUuid, parentUuid);
        });
    } else {
        log.info("No parent found → No hierarchy created for {}", childUuid);
        hierarchyFuture = CompletableFuture.completedFuture(null);
    }

    // ---------------- STEP 5: Wait for all parallel tasks ----------------
    CompletableFuture.allOf(addressFuture, secondUpdateFuture, hierarchyFuture).join();

    log.info("Completed processOrganisationUnit for orgNumber: {}", orgNumber);
}
