package com.ing.datadist.api.service; import com.ing.datadist.api.model.CreateOrganisationUnitRequest; import com.ing.datadist.api.model.CreateOrganisationUnitNameRequest; import com.ing.datadist.api.model.InvolvedPartiesOrganisationUnitResponse; import com.ing.datadist.api.model.UpdateExternalIdentifierOrganisationUnitRequest; import com.ing.datadist.api.model.OrganisationUnitOrganisationRelationshipRequest; import com.ing.datadist.configreader.CofaceOpsConfigReader; import static com.ing.datadist.api.utils.DataDistributionConstants.DATA_SOURCE; import static com.ing.datadist.api.utils.DataDistributionConstants.LOGICAL_DATA_DOMAIN; import static com.ing.datadist.api.utils.DataDistributionConstants.LANGUAGE; import static com.ing.datadist.api.utils.DataDistributionConstants.CHANNEL_OF_ENTRY; import static com.ing.datadist.api.utils.DataDistributionConstants.ORGANISATION_UNIT_NAME_TYPE; import static com.ing.datadist.api.utils.DataDistributionConstants.STRUCTURE_TYPE; import static com.ing.datadist.api.utils.DataDistributionConstants.EXTERNAL_ID_TYPE; import static com.ing.datadist.api.utils.DataDistributionConstants.EXTERNAL_ID_STATUS; import static com.ing.datadist.api.utils.DataDistributionConstants.PLACE_OF_ISSUE; import static com.ing.datadist.api.utils.DataDistributionConstants.ROLE_REASON_TYPE; import lombok.extern.slf4j.Slf4j; import org.springframework.stereotype.Service; import java.time.ZonedDateTime; import java.time.format.DateTimeFormatter; import java.util.Collections; import java.util.List; import java.util.Map; import java.util.concurrent.ExecutionException; @Service @Slf4j public class OrganisationUnitService { private final OnePamRepository onePamRepository; private final CofaceOpsConfigReader configReader; public OrganisationUnitService(OnePamRepository onePamRepository, CofaceOpsConfigReader configReader) { this.onePamRepository = onePamRepository; this.configReader = configReader; } public void processOrganisationUnit(String orgNumber) { InvolvedPartiesOrganisationUnitResponse response = createOrganisationUnit(orgNumber); String uuid = response.getInvolvedPartyIdentifier(); if (uuid == null || uuid.isBlank()) { log.warn("No involvedPartyIdentifier found in response"); return; } UpdateExternalIdentifierOrganisationUnitRequest updateRequest = buildUpdateRequest(orgNumber); updateExternalIdentifier(uuid, updateRequest); //start changes here......async parallel calls for API } private InvolvedPartiesOrganisationUnitResponse createOrganisationUnit(String orgNumber) { List<Map<String, String>> configs = configReader.fetchByOrgNumber(orgNumber); Map<String, String> config = configs.isEmpty() ? Collections.emptyMap() : configs.get(0); String orgUnitName = config.get("organisationUnitName"); String countryOfResidence = config.get("countryOfResidence"); String effectiveDate = config.get("dateOfIssue"); if (orgUnitName == null || orgNumber == null || countryOfResidence == null || effectiveDate == null) { log.warn("Missing config values for organisation unit: {}", orgNumber); throw new RuntimeException("Missing config for organisation unit"); } CreateOrganisationUnitRequest request = CreateOrganisationUnitRequest.builder() .dataSource(DATA_SOURCE) .logicalDataDomain(LOGICAL_DATA_DOMAIN) .countryOfResidence(countryOfResidence) .preferredLanguage(LANGUAGE) .channelOfEntry(CHANNEL_OF_ENTRY) .organisationUnitStructureType(STRUCTURE_TYPE) .effectiveDate(effectiveDate) .organisationUnitNames(Collections.singletonList( CreateOrganisationUnitNameRequest.builder() .organisationUnitNameType(ORGANISATION_UNIT_NAME_TYPE) .organisationUnitName(orgUnitName) .build())) .build(); try { return onePamRepository.createInvolvedParty(request).get(); } catch (InterruptedException | ExecutionException e) { log.error("Failed to create organisation unit", e); Thread.currentThread().interrupt(); throw new RuntimeException("Creation failed", e); } } private UpdateExternalIdentifierOrganisationUnitRequest buildUpdateRequest(String orgNumber) { List<Map<String, String>> configs = configReader.fetchByOrgNumber(orgNumber); Map<String, String> config = configs.isEmpty() ? Collections.emptyMap() : configs.get(0); String uuid = config.get("uuid"); String countryOfIssue = config.get("countryOfResidence"); String dateOfIssue = config.get("dateOfIssue"); String expiryDate = config.get("expiryDate"); if (uuid == null || countryOfIssue == null || dateOfIssue == null || expiryDate == null) { log.warn("Missing config values for external identifier update: {}", orgNumber); throw new RuntimeException("Missing config for external identifier update"); } return UpdateExternalIdentifierOrganisationUnitRequest.builder() .involvedPartyExternalIdentifierType(EXTERNAL_ID_TYPE) .involvedPartyExternalIdentifierValue(uuid) .involvedPartyExternalIdentifierStatusType(EXTERNAL_ID_STATUS) .countryOfIssue(countryOfIssue) .placeOfIssue(PLACE_OF_ISSUE) .dateOfIssue(dateOfIssue) .expiryDate(expiryDate) .dataSource(DATA_SOURCE) .effectiveDate(dateOfIssue) .endDate(ZonedDateTime.now().plusYears(10).format(DateTimeFormatter.ISO_OFFSET_DATE_TIME)) .build(); } private void updateExternalIdentifier(String uuid, UpdateExternalIdentifierOrganisationUnitRequest request) { try { onePamRepository.updateExternalIdentifier(uuid, request).get(); log.info("Successfully updated external identifier for UUID: {}", uuid); } catch (InterruptedException | ExecutionException e) { log.error("Failed to update external identifier", e); Thread.currentThread().interrupt(); throw new RuntimeException("Update failed", e); } } private void createOrganisationUnitHierarchy(String childId, String parentId) { OrganisationUnitOrganisationRelationshipRequest request = OrganisationUnitOrganisationRelationshipRequest.builder() .childOrganisationUnitIdentifier(childId) .parentOrganisationIdentifier(parentId) .parentRoleReasonType(ROLE_REASON_TYPE) .dataSource(DATA_SOURCE) .build(); try { onePamRepository.createOrganisationUnitHierarchy(request).get(); log.info("Successfully created hierarchy between child: {} and parent: {}", childId, parentId); } catch (InterruptedException | ExecutionException e) { log.error("Failed to create organisation unit hierarchy", e); Thread.currentThread().interrupt(); throw new RuntimeException("Hierarchy creation failed", e); } } } package com.ing.datadist.api.service; import com.fasterxml.jackson.databind.ObjectMapper; import com.ing.apisdk.toolkit.connectivity.api.JavaService; import com.ing.apisdk.toolkit.connectivity.transport.http.japi.RichHttpRequestBuilder; import com.ing.apisdk.toolkit.connectivity.transport.http.japi.RichHttpRequestBuilderException; import com.ing.datadist.api.config.InvolvedPartyApiProperties; import com.ing.datadist.api.exception.DataDistributionApiException; import com.ing.datadist.api.model.*; import com.ing.datadist.api.utils.RegkeyEnum; import com.twitter.finagle.http.Method; import com.twitter.finagle.http.Request; import com.twitter.finagle.http.Response; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Qualifier; import org.springframework.stereotype.Component; import scala.collection.JavaConverters; import java.util.Map; import java.util.concurrent.CompletableFuture; @Slf4j @Component public class OnePamRepository { private final JavaService<Request, Response> apiClient; private final ObjectMapper objectMapper; private final InvolvedPartyApiProperties apiProperties; public OnePamRepository(@Qualifier("integrationServiceGeneric") JavaService<Request, Response> apiClient, ObjectMapper objectMapper, InvolvedPartyApiProperties apiProperties) { this.apiClient = apiClient; this.objectMapper = objectMapper; this.apiProperties = apiProperties; } // ============================================================ // CREATE INVOLVED PARTY // ============================================================ public CompletableFuture<InvolvedPartiesOrganisationUnitResponse> createInvolvedParty(CreateOrganisationUnitRequest payload) { try { String url = RegkeyEnum.CREATE_INVOLVED_PARTY.endpoint; Request request = new RichHttpRequestBuilder() .withUrl(url) .withMethod(Method.Post()) .withJsonContent(payload) .withHeader("X-ING-LastUpdateUse", "IN_ADMIN") .build(); return apiClient.apply(request) .thenApply(response -> { try { return objectMapper.readValue(response.contentString(), InvolvedPartiesOrganisationUnitResponse.class); } catch (Exception e) { throw new DataDistributionApiException( RegkeyEnum.CREATE_INVOLVED_PARTY, "Failed to parse response from Involved Party API", e.getMessage() ); } }); } catch (RichHttpRequestBuilderException e) { throw new DataDistributionApiException( RegkeyEnum.CREATE_INVOLVED_PARTY, "Failed to build request for create involved party API", e.getMessage() ); } } // ============================================================ // UPDATE EXTERNAL IDENTIFIER // ============================================================ public CompletableFuture<Void> updateExternalIdentifier(String uuid, UpdateExternalIdentifierOrganisationUnitRequest payload) { try { String url = RegkeyEnum.UPDATE_EXTERNAL_IDENTIFIER.resolveEndpoint(uuid); Request request = new RichHttpRequestBuilder() .withUrl(url) .withMethod(Method.Post()) .withJsonContent(payload) .withHeader("X-ING-LastUpdateUse", "IN_ADMIN") .build(); return apiClient.apply(request) .thenApply(response -> { if (response.statusCode() >= 200 && response.statusCode() < 300) { return null; } else { throw new DataDistributionApiException( RegkeyEnum.UPDATE_EXTERNAL_IDENTIFIER, "Failed to update external identifier", "Status: " + response.statusCode() ); } }); } catch (RichHttpRequestBuilderException e) { throw new DataDistributionApiException( RegkeyEnum.UPDATE_EXTERNAL_IDENTIFIER, "Failed to build request for update external identifier API", e.getMessage() ); } } // ============================================================ // CREATE ORGANISATION UNIT HIERARCHY // ============================================================ public CompletableFuture<Void> createOrganisationUnitHierarchy(OrganisationUnitOrganisationRelationshipRequest payload) { try { String url = RegkeyEnum.CREATE_ORGANISATION_UNIT_HIERARCHY.endpoint; Request request = new RichHttpRequestBuilder() .withUrl(url) .withMethod(Method.Post()) .withJsonContent(payload) .withHeader("X-ING-LastUpdateUse", "IN_ADMIN") .build(); return apiClient.apply(request) .thenApply(response -> { if (response.statusCode() >= 200 && response.statusCode() < 300) { return null; } else { throw new DataDistributionApiException( RegkeyEnum.CREATE_ORGANISATION_UNIT_HIERARCHY, "Failed to create organisation unit hierarchy", "Status: " + response.statusCode() ); } }); } catch (RichHttpRequestBuilderException e) { throw new DataDistributionApiException( RegkeyEnum.CREATE_ORGANISATION_UNIT_HIERARCHY, "Failed to build request for organisation unit hierarchy API", e.getMessage() ); } } // ============================================================ // SEARCH INVOLVED PARTY BY INTERNAL IDENTIFIER // ============================================================ public CompletableFuture<SearchInvolvedPartiesResponseV1> searchInvolvedPartyByInternalIdentifier(SearchInvolvedPartiesRequestV1 payload) { try { String url = RegkeyEnum.SEARCH_ORGANISATION_UNIT.endpoint;  // ✅ dynamically from enum log.info("searchInvolvedPartyByInternalIdentifier request payload: {}", payload); String jsonPayload = objectMapper.writeValueAsString(payload); Request request = new RichHttpRequestBuilder() .withUrl(url) .withMethod(Method.Post()) .withJsonContent(jsonPayload) .withHeader("Content-Type", "application/json") .build(); printRequest(request); return apiClient.apply(request) .thenApply(response -> { try { log.info("searchInvolvedPartyByInternalIdentifier response: {}", response); return objectMapper.readValue(response.contentString(), SearchInvolvedPartiesResponseV1.class); } catch (Exception e) { log.error("searchInvolvedPartyByInternalIdentifier error: {}", e.getMessage()); throw new DataDistributionApiException( RegkeyEnum.SEARCH_ORGANISATION_UNIT, "Failed to parse response from search organisation unit API", e.getMessage() ); } }); } catch (Exception e) { log.error("searchInvolvedPartyByInternalIdentifier API error: {}", e.getMessage()); throw new DataDistributionApiException( RegkeyEnum.SEARCH_ORGANISATION_UNIT, "Failed to build request for search organisation unit API", e.getMessage() ); } } // ============================================================ // UPDATE ORGANISATION UNIT NAME // ============================================================ public CompletableFuture<UpdateOrganisationUnitNameV5Response> updateOrganisationUnitName( UpdateOrganisationUnitNameV5Request payload, String uuid, String nameType) { try { String url = RegkeyEnum.UPDATE_ORGANISATION_UNIT_NAME.resolveEndpoint(uuid, nameType); Request request = new RichHttpRequestBuilder() .withUrl(url) .withMethod(Method.Patch()) .withJsonContent(payload) .withHeader("X-ING-LastUpdateUser", "X-ING-LastUpdateUser") .build(); return apiClient.apply(request) .thenApply(response -> { try { return objectMapper.readValue(response.contentString(), UpdateOrganisationUnitNameV5Response.class); } catch (Exception e) { throw new DataDistributionApiException( RegkeyEnum.UPDATE_ORGANISATION_UNIT_NAME, "Failed to parse response from updateOrganisationUnitName API", e.getMessage() ); } }); } catch (RichHttpRequestBuilderException e) { throw new DataDistributionApiException( RegkeyEnum.UPDATE_ORGANISATION_UNIT_NAME, "Failed to build request for updateOrganisationUnitName API", e.getMessage() ); } } // ============================================================ // UPDATE INVOLVED PARTY // ============================================================ public CompletableFuture<UpdateInvolvedPartyResponseV5> updateInvolvedParty(UpdateInvolvedPartyRequestV5 payload, String uuid) { try { String url = RegkeyEnum.UPDATE_INVOLVED_PARTY.resolveEndpoint(uuid); Request request = new RichHttpRequestBuilder() .withUrl(url) .withMethod(Method.Patch()) .withJsonContent(payload) .withHeader("X-ING-LastUpdateUser", "X-ING-LastUpdateUser") .build(); return apiClient.apply(request) .thenApply(response -> { try { return objectMapper.readValue(response.contentString(), UpdateInvolvedPartyResponseV5.class); } catch (Exception e) { throw new DataDistributionApiException( RegkeyEnum.UPDATE_INVOLVED_PARTY, "Failed to parse response for Update InvolvedParty Request API", e.getMessage() ); } }); } catch (RichHttpRequestBuilderException e) { throw new DataDistributionApiException( RegkeyEnum.UPDATE_INVOLVED_PARTY, "Failed to build request for Update InvolvedParty Request API", e.getMessage() ); } } // ============================================================ // REQUEST LOGGER // ============================================================ private static void printRequest(Request req) { try { log.info("----- Request Details -----"); log.info("Method: {}", req.method()); log.info("URI: {}", req.uri()); log.info("Version: {}", req.version()); Map<String, String> headerMap = JavaConverters.mapAsJavaMapConverter(req.headerMap()).asJava(); for (Map.Entry<String, String> entry : headerMap.entrySet()) { log.info("Header: {}: {}", entry.getKey(), entry.getValue()); } log.info("Body: {}", req.contentString()); log.info("---------------------------"); } catch (Exception e) { log.error("Exception while printing request", e); } } } package com.ing.datadist.api.service; import com.ing.datadist.api.model.*; import com.ing.datadist.domain.OrganisationUnitDomainWrapper; import lombok.extern.slf4j.Slf4j; import org.springframework.stereotype.Service; import java.util.List; import java.util.Objects; @Service @Slf4j public class UpdateOrganisationUnitService { public void updateOrganisationUnit(OrganisationUnitDomainWrapper wrapper, SearchInvolvedPartiesResponseV1 response) throws Exception { String uuid = wrapper.getOpsUUID(); List<SearchOrganisationUnitResponseV1> organisationUnits = response.getOrganisationUnits(); for (SearchOrganisationUnitResponseV1 organisationUnit : organisationUnits) { List<SearchOrganisationUnitNameResponseV1> organisationUnitNames = organisationUnit.getOrganisationUnitNames(); List<SearchOrganisationUnitAddressResponseV1> postalAddresses = organisationUnit.getPostalAddresses(); List<SearchOrganisationUnitDigitalAddressesV1> digitalAddresses = organisationUnit.getDigitalAddresses(); for (SearchOrganisationUnitNameResponseV1 name : organisationUnitNames) { if (Objects.equals(wrapper.getOrganisationUnitName(), name.getOrganisationUnitName())) { log.info("Update organisationUnit name changed for uuid:{} old:{} new:{} ", uuid, wrapper.getOrganisationUnitName(), name.getOrganisationUnitName()); //Call update name API } } for (SearchOrganisationUnitAddressResponseV1 address : postalAddresses) { if (Objects.equals(wrapper.getPostalAddressStreetNm(), address.getStreetName())) { log.info("Update organisationUnit StreetName changed for uuid:{} old:{} new:{} ", uuid, wrapper.getPostalAddressStreetNm(), address.getStreetName()); //Call update postal addr API } if (Objects.equals(wrapper.getPostalAddressHouseNum(), address.getHouseNumber())) { log.info("Update organisationUnit HouseNum changed for uuid:{} old:{} new:{} ", uuid, wrapper.getPostalAddressHouseNum(), address.getHouseNumber()); //Call update postal addr API } if (Objects.equals(wrapper.getPostalAddressHouseAdd(), address.getHouseNumberAddition())) { log.info("Update organisationUnit HouseAdd changed for uuid:{} old:{} new:{} ", uuid, wrapper.getPostalAddressHouseAdd(), address.getHouseNumberAddition()); //Call update postal addr API } if (Objects.equals(wrapper.getPostalAddressPostalCd(), address.getPostalCode())) { log.info("Update organisationUnit PostalCode changed for uuid:{} old:{} new:{} ", uuid, wrapper.getPostalAddressPostalCd(), address.getPostalCode()); //Call update postal addr API } if (Objects.equals(wrapper.getPostalAddressCityName(), address.getCityName())) { log.info("Update organisationUnit CityName changed for uuid:{} old:{} new:{} ", uuid, wrapper.getPostalAddressCityName(), address.getCityName()); //Call update postal addr API } if (Objects.equals(wrapper.getPostalAddressCntryCd(), address.getCountryCode())) { log.info("Update organisationUnit CountryCode changed for uuid:{} old:{} new:{} ", uuid, wrapper.getPostalAddressCntryCd(), address.getCountryCode()); //Call update postal addr API } } for (SearchOrganisationUnitDigitalAddressesV1 digitalAddress : digitalAddresses) { if (Objects.equals(wrapper.getDigitalAddrEmail(), digitalAddress.getFullDigitalAddress())) { log.info("Update organisationUnit FullDigitalAddress changed for uuid:{} old:{} new:{} ", uuid, wrapper.getDigitalAddrEmail(), digitalAddress.getFullDigitalAddress()); //Call update digital addr API } if (Objects.equals(wrapper.getDigitalAddrFullTefgn(), digitalAddress.getFullDigitalAddress())) { log.info("Update organisationUnit FullDigitalAddress changed for uuid:{} old:{} new:{} ", uuid, wrapper.getDigitalAddrFullTefgn(), digitalAddress.getFullDigitalAddress()); //Call update digital addr API } if (Objects.equals(wrapper.getDigitalAddrFullTel(), digitalAddress.getFullDigitalAddress())) { log.info("Update organisationUnit FullDigitalAddress changed for uuid:{} old:{} new:{} ", uuid, wrapper.getDigitalAddrFullTel(), digitalAddress.getFullDigitalAddress()); //Call update digital addr API } } } } } package com.ing.datadist.api.utils; import jakarta.ws.rs.HttpMethod; import lombok.Generated; import static org.apache.commons.lang3.StringUtils.SPACE; @Generated public enum RegkeyEnum { // ✅ OnePam endpoints CREATE_INVOLVED_PARTY("CREATE_INVOLVED_PARTY", HttpMethod.POST, "https://api.ing.com/v5/involved-parties"), UPDATE_EXTERNAL_IDENTIFIER("UPDATE_EXTERNAL_IDENTIFIER", HttpMethod.POST, "https://api.ing.com/v5/involved-parties/{uuid}/external-identifiers"), CREATE_ORGANISATION_UNIT_HIERARCHY("CREATE_ORGANISATION_UNIT_HIERARCHY", HttpMethod.POST, "https://api.ing.com/v1/organisation-hierarchies/relationship"), SEARCH_ORGANISATION_UNIT("SEARCH_ORGANISATION_UNIT", HttpMethod.POST, "https://api.ing.com/v2/partyandagreementsearch/involved-parties/organisation-units/search"), UPDATE_INVOLVED_PARTY("UPDATE_INVOLVED_PARTY", HttpMethod.PATCH, "https://api.ing.com/v5/involved-parties/{uuid}"), CLOSE_ORGANISATION_HIERARCHY_RELATIONSHIP("CLOSE_ORGANISATION_HIERARCHY_RELATIONSHIP", HttpMethod.POST, "https://api.ing.com/v1/organisation-hierarchies/relationship/{uuid}/close"), UPDATE_ORGANISATION_UNIT_NAME("UPDATE_ORGANISATION_UNIT_NAME", HttpMethod.POST, "https://api.ing.com/v5/involved-parties/{uuid}/organisation-unit-names "); public final String label; public final String method; public final String endpoint; RegkeyEnum(String label, String method, String endpoint) { this.label = label; this.method = method; this.endpoint = endpoint; } /** * Dynamically replaces path variables like {uuid} with actual values. */ public String resolveEndpoint(String... values) { String resolved = endpoint; for (String value : values) { resolved = resolved.replaceFirst("\\{[^}]+}", value); } return resolved; } @Override public String toString() { return label + " || " + method + SPACE + endpoint; } } package com.ing.datadist.batch.tasklet; import com.ing.datadist.api.model.SearchInvolvedPartiesResponseV1; import com.ing.datadist.api.model.SearchOrganisationUnitListResponseV2; import com.ing.datadist.api.service.OrganisationUnitSearchService; import com.ing.datadist.api.service.OrganisationUnitService; import com.ing.datadist.api.service.UpdateOrganisationUnitService; import com.ing.datadist.domain.OrganisationUnitDomainWrapper; import com.ing.datadist.domain.TaskletCofaceOpsDomainWrapper; import lombok.extern.slf4j.Slf4j; import org.springframework.batch.core.StepContribution; import org.springframework.batch.core.configuration.annotation.StepScope; import org.springframework.batch.core.scope.context.ChunkContext; import org.springframework.batch.core.step.tasklet.Tasklet; import org.springframework.batch.repeat.RepeatStatus; import org.springframework.stereotype.Component; import java.util.List; @Component @StepScope @Slf4j public class OnePamSearchApiTasklet implements Tasklet { private final static String UPDATE_ACTION_TYPE = "UPD"; private final static String DELETE_ACTION_TYPE = "DEL"; private final static String INSERT_ACTION_TYPE = "INS"; private final OrganisationUnitSearchService searchService; private final OrganisationUnitService organisationUnitService; private final UpdateOrganisationUnitService updateOrganisationUnitService; private final TaskletCofaceOpsDomainWrapper taskletCofaceOpsDomainWrapper; public OnePamSearchApiTasklet(OrganisationUnitSearchService searchService, OrganisationUnitService organisationUnitService, UpdateOrganisationUnitService updateOrganisationUnitService, TaskletCofaceOpsDomainWrapper taskletCofaceOpsDomainWrapper) { this.searchService = searchService; this.organisationUnitService = organisationUnitService; this.updateOrganisationUnitService = updateOrganisationUnitService; this.taskletCofaceOpsDomainWrapper = taskletCofaceOpsDomainWrapper; } @Override public RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception { try { List<OrganisationUnitDomainWrapper> wrappers = taskletCofaceOpsDomainWrapper.getCofaceOpsDomainWrapper(); log.info("OnePamSearchApiTasklet wrappers size:" + wrappers.size()); for (OrganisationUnitDomainWrapper domainWrapper : wrappers) { try { String actionType = domainWrapper.getRecordActionType(); if (UPDATE_ACTION_TYPE.equalsIgnoreCase(actionType)) { SearchInvolvedPartiesResponseV1 result = searchService.searchOrganisationUnitByInternalIdentifier("UUID", domainWrapper.getOpsUUID()); if (result != null && result.getTotalNumberOfResults() > 0) { updateOrganisationUnitService.updateOrganisationUnit(domainWrapper,result); } else { log.error("searchOrganisationUnit api No data found for UUID {}", domainWrapper.getOpsUUID()); } } else if (INSERT_ACTION_TYPE.equalsIgnoreCase(actionType)) { organisationUnitService.processOrganisationUnit(domainWrapper.getOpsUUID()); } } catch (Exception e) { log.error("Exception occurred while executing API call for UUID :{} error :{}", domainWrapper.getOpsUUID(), e.getMessage()); } } } catch (Exception ex) { log.error("Exception occurred while executing OnePamSearchApiTasklet : {}", ex.getMessage()); } return RepeatStatus.FINISHED; } }
