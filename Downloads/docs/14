3. Phase 2: OnePAM Main LDD Update  4. Phase 3: add MADP  • Phase 3a: MADP External DD Upload  • Phase 3b: MADP Main DD Update  Part 3 – Detailed architecture  1. OnePAM & MADP Detailed Architecture  2. Data fragmentation, Model Transformation,  Filtering & deduplication  3. OnePAM/MADP attribute mapping and  reading & updating  4. OnePAM API, OIL & Notifications  5. OnePAM Main LDD Involved Party  identification & Self-healing  6. MADP uploads  7. Human Process interaction  8. End-to-End architecture view  40 Architectural Decisions (1/2)  1. We support both File-based as API-based upload and update scenarios  • Why: different drivers for using API and Files. For small numbers of ingested records that are urgent (bancruptcies, Incapables) APIs give us  better control over the ingest process. For large numbers of Ingested records, file-based uploads are better (also required by GCDM).  • Consequence: more flexibility (if configuration driven) but more complex application  2. Data Ingestor filters out disaggregated ingested records that have not changed  • Why: We want to be efficient and remain within upload time windows. As upload throughputs are limited and OnePAM anyway verifies and  doesn’t overwrite attributes that didn’t change, leading to wasted cycles.  • Consequence: unchanged records don’t ‘touch’ the associated OnePAM objects and don’t change the meta-data  3. Before uploading/updating data we read current OnePAM & MADP Parties & Relationships to obtain a before-view.  • Why: We don’t know what exact attributes changed of an ingested disaggregated record. Comparing the before-view with the ingested  change-view allows us to identify the exact attribute changes and provide only changed data to upload improving throughput. It is necessary  when using asynchronous notifications (file uploads) to know when all updates have been captured.  • Consequence: balance between time spent reading (1000 tps) vs uploading unchanged attributes (5 tps).  4. We use a dedicated DD-UUID, managed by the Data Distributor.  • Why: To support deduplication of Parties by storing demographics & LE# in the DD-store (disambiguation service impact tbd). To create new  Parties in the OnePAM External LDD using OIL, a 3rd party identifier is required. To Support reconciliation and refreshes as a primary key to  provide mappings to External and Main UUIDs. (Quid Polygraph?)  • Consequence: We need to request GCDM for a new “InternalIdentifier” attribute value for OnePAM (e.g. BE_CD_DD).  • Remark: OnePAM has a feature where its UUIDs can be created outside OnePAM (feature request to be made). This may eliminate the need for  a separate DD-UUID.  41 Architectural Decisions (2/2)  4. Historization is in the UDL, we don’t keep historization of attribute changes in the Ingestor or Distributor.  • Why: Because. It’s what the UDL if for. The Data Distributor as an operational system should not be concerned with this.  • Consequence: we use data from the UDL for refreshes and reconciliations rather than that in OnePAM and MADP.  42 Risks  • The largest risk is that current OnePAM throughput is limited.  • Regardless of implementation (file/API) we are not sure if it can manage all Ingest loads, when we have a full end-to-end scenario with OnePAM  External & Main LDD and MADP data.  • We should open a negotiation with GCDM to get at least 25 TPM (API)/25 RPM.  • For the moment we can live with the lower througputs as we only have to update the OnePAM External LDD.  • Total throughput time must remain within permitted time windows (6-8 hours)*.  • The total throughput time from arrival of the external file to be ingested through Data Ingestor/Distributor up to OnePAM Main LDD & MADP Main  DDs could be extensive due to amount of processing, handovers and asynchronicity.  • We update in 6 stages: Read/update OnePAM External LDD, Read/Update MADP External DD, Read/Update OnePAM Main LDD, Read/Update  MADP Main DDs.  • With Files for OIL and MADP, given that the file-based uploads are asynchronous, we must capture Notifications of changes to be sure all records  are successfully written before moving to the next phase. We don’t know yet how fast Notifications will come through.  • APIs are synchronous giving us more control but constraint by API throughput limits (5 tx/s). This works for smaller updates but breaks down for  larger updates. GCDM requires file uploads for larger volumes.  • The assumption that Notifications will allow us to capture all changes to account whether all updates have been done remains to be  tested.  • Updating Main LDD may be difficult because of the multiple sources of data that concur to define the “truth” (survivorship) – to be  tackled in the policies.  43  *In principle daily upload files should be < 10K updated records per file and at supported OIL update rates this should be feasible Open Points  • A number of business modeling decisions have not yet been taken:  • Sole Trader ingested Party object not yet modeled for external LDD (proposal is different than Main LDD) or know how to treat it.  • Legal representative approach not yet defined.  • Some ingested Party objects have bad data quality (Legal Representatives without address) or have limited information (administrators) risking to  have several duplicates. Decision how to treat those is open.  • An important open question to move from External to Main zones is what the granularity must be for an upload in the External Zones  to be considered successful before updating the Main zones:  • The original ingested composite record? (How will DD even know what records it ingests were part of it?)  • The by DD ingested disaggregated record?  • Individual uploaded attributes?  • For the OnePAM Main LDD there may be competing updates for attributes (e.g. Cube). How to prioritize and know that the attribute  you may update is not updated by another source having a higher priority (see ‘survivorship’ in the next slide)  • The use of a central entity matching (disambiguation) mechanism is on the table but not yet designed.  • GCDM open points:  • Challenge on ‘voluminous’ data volumes: use of External LDD for LE/OpSites (10M disaggregated records)  • Throughput performance (25 tps/rps instead of 3-5 tps/rps),  • define OnePAM UUID outside OnePAM  • Ability to not need an external source UUID (DD-UUID).  *In principle daily upload files should be < 10K updated records per file and at supported OIL update rates this should be feasible  ** Airflow could be a possible solution according to Kjell Moens.  44 Part 2: Phased  Approach &  Patterns  Table of Content  Part 1 – High-level architecture  1. Context  2. Constraints & mitigation strategies  • Environmental constraints  • Mitigation strategies  3. High-level Architecture  • Data Distributor  • Data Refresher & Reconciler intro  • Data Refresher  • Data Reconciler  4. Architecture decisions, risks & open points  Part 2 – Phased approach & Patterns  1. Phase & Pattern overview  2. Phase 1: OnePAM External LDD Upload  3. Phase 2: OnePAM Main LDD Update  4. Phase 3: add MADP  • Phase 3a: MADP External DD Upload  • Phase 3b: MADP Main DD Update  Part 3 – Detailed architecture  1. OnePAM & MADP Detailed Architecture  2. Data fragmentation, Model Transformation,  Filtering & deduplication  3. OnePAM/MADP attribute mapping and  reading & updating  4. OnePAM API, OIL & Notifications  5. OnePAM Main LDD Involved Party  identification & Self-healing  6. MADP uploads  7. Human Process interaction  8. End-to-End architecture view  46 An evolutionary architectural approach  Phase 1: Now  OnePAM External LDD 
 1. Initial  load  OnePAM  External  LDD  3. Refresh  OnePAM  External  LDD  2. Daily  Update  OnePAM  External  LDD  Phase 2: Later  OnePAM Main LDD  Shadow  ‘reconciliation’ run  5. Daily load  OnePAM  Main LDD  Phase 3: Whenever relevant  MADP External & Main DD  7. Daily loads  MADP External &  Main Data  Domains  8.  Reconciliatio  n MADP  Main Data  Domains  4.  Reconciliation  OnePAM  External &  Main LDD  We start with an architecture that only  Uploads Party Data to the OnePAM  External LDD:  We extend the architecture  with updating Involved Party  data in the OnePAM Main  LDD:  6. Initial  load MADP  External  Data  Domain  8. Refresh  MADP  External  Data  Domain  We finish with incorporating Uploading & Updating the MADP  External & Main Data Domains when becoming relevant.  47 Initial Load  Different Data Distributor Upload and Update Patterns  48  Phase 1:  OnePAM External LDD Upload  Phase 2:  OnePam Main LDD Update  Phase 3a:  MADP External DD Upload  Phase 3b:  MADP Main DD Update  Daily Load  Corrections  • Very first (empty db)  • Independent (no overlap)  • Relationship creating  • Object sharing diff attr.  • Object sharing same attr.  There is no initial load from the  perspective of the Data  Distributor as it already  contains data by other sources  & DD is not master.  • Object sharing diff attr. There is no initial load from the  perspective of the Data  Distributor as it already  contains data by other sources  & DD is not master.  • File based  • larger files  • Scheduled OIL  • API based  • Urgent, smaller files  • API based • File based (larger files)  • Automated  • API based (urgent files)  Follows OnePAM External LDD  Upload  • API based  Follows OnePAM Main LDD  Update  • Refresh  • converted into “daily  load”  • File based (larger)  • Manual OIL  • Reconciliation  • First one acts as initial  load equivalent  • Converted into “daily  load”  • File based  • Manual OIL  • Refresh  • converted into “daily  load”  • File based  • Automated  • Reconciliation  • First one acts as initial  load equivalent  • Converted into “daily  load”  • File based  • Automated Table of Content  Part 1 – High-level architecture  1. Context  2. Constraints & mitigation strategies  • Environmental constraints  • Mitigation strategies  3. High-level Architecture  • Data Distributor  • Data Refresher & Reconciler intro  • Data Refresher  • Data Reconciler  4. Architecture decisions, risks & open points  Part 2 – Phased approach & Patterns  1. Phase & Pattern overview  2. Phase 1: OnePAM External LDD Upload  3. Phase 2: OnePAM Main LDD Update  4. Phase 3: add MADP  • Phase 3a: MADP External DD Upload  • Phase 3b: MADP Main DD Update  Part 3 – Detailed architecture  1. OnePAM & MADP Detailed Architecture  2. Data fragmentation, Model Transformation,  Filtering & deduplication  3. OnePAM/MADP attribute mapping and  reading & updating  4. OnePAM API, OIL & Notifications  5. OnePAM Main LDD Involved Party  identification & Self-healing  6. MADP uploads  7. Human Process interaction  8. End-to-End architecture view  49 Phase 1: OnePAM External LDD upload  50  Data Reconciler  MADP  Data Distributor   Initial Load  Unite Data  Lake (UDL)  DD Store  UUID/EM table Record/Attr table Error table  4  Data Refresher  OnePAM  Daily Load  Refresh Load  OnePAM  MADP  Policy Table Record/Attr table  Upload Response Read Read Upload/  Update  Upload/  Update Response  Entity Match Insert changed  attributes  Decide action  on attribute  Validate attribute  update  Process update  errors  Response  1  Data  Ingest DI  2  Only when refresh/reconciliation is triggered  4 4  5  3 7  6  7 8 8  9 10 Configuration  External LDD  Main LDD  Cassandra  External Data  Domain  (Ingested  Parties)  Main  Data  Domain  (Involved  Parties)  Data Steward  Tool  Event  Layer  11 12  Disambiguation service** Phase 1: OnePAM External LDD Upload  Refresher  Ingested Party  Record, ING  formatted &  enriched  Preprocess Upload  3 activities:  1. Initial Upload of Parties (~10M disaggregated uploadable records) – File based  • The very first upload of any ingested source – LE & Operating Sites  • Subsequent first uploads of other ingested sources (bankruptcies, incapables,  legal representatives)  2. Daily Upload of Parties – File & API based, depending on type of file  • Legal Entities & Operating Sites (~50-60K disaggregated uploadable  records):  File or API-based  • Bankruptcies (10s-100s of disaggregated records): API-based  • Incapables (10s-100s of disaggregated records): API-based  • Legal representatives: TBD (not in immediate scope)  3. Refreshes (~10M disaggregated uploadable records) – File based  • We don’t do an upload of all these records as most didn’t change.  Upload  OnePAM  External LDD  Upload  2 process steps:  1. Preprocess External Upload:  • Entity Matching of Parties (if needed)  • Data Distributor UUID creation for new Parties  2. Upload OnePAM External LDD:  • Get ‘before’ view to identify changed attributes (if  needed)  • Upload Core model changed attributes (OIL files or  API)  • Capture upload results (Notifications or API response)  51  • We will transform them into a Daily Upload using the UDL IP2IP  relationship  Legal  Entity  Legal  Entity  The Data Distributor gets presented with different files as initial  loads in a serial way: Legal Entities (& Sole traders*), Operating  Sites, Bankruptcies, Incapables.  The first file will encounter an empty External LDD & there is no  assumption of overlaps of relationships between parties  From the second file on there may be overlaps in Parties  (Individuals/Organization) requiring entity matching as well as  relationships with Organizations that must be created.  That means that from the second file onwards, when there is an  entity match, we must update the object, rather than create it, and  whether we update overlapping attributes.  We also must evaluate if an upload would result in a Notification  (there is no Notification when all info is the same) to know  whether the upload succeeded or not.  52  The overlapping Party nature in initial loads must be considered  Individual Organization OrganizationalUnit  Sole  trader  Sole  trader  Operating  Site  Legal  Entity  Incapable  Legal  Representative  Bankruptcy  Administrator  Incapable  administrator  OrganizationHierarchy  relationship  Can be same  object  File presented to DD  IP2IP relationship  * Sole traders exact modeling in OnePAM External LDD is still under consideration. The current shown proposal is not yet approved and may change as it is not aligned with the model in OnePAM Main LDD. Order File Object Potential overlap Relationship  1 Legal Entity LE No No  2 Operating Site Operating site No Legal Entity (Hierarchy)  3 Bankruptcies Bancruptcy Administrator No Legal Entity (IP2IP)  4 Incapable Incapable Yes Individual* No  5 Incapable Incapable Administrator Yes Individual Incapable (IP2IP)  6 Sole trader Sole trader Organization* 
